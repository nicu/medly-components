"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),n=require("../../helpers/cookieStorage/cookieStorage.js"),o=require("../../helpers/localStorage/localStorage.js"),r=require("../../helpers/sessionStorage/sessionStorage.js"),a=(e=require("@babel/runtime/helpers/slicedToArray"))&&"object"==typeof e&&"default"in e?e.default:e,c=require("./Storage.context.js"),i={localStorage:o.LOCAL_STORAGE,sessionStorage:r.SESSION_STORAGE,cookieStorage:n.COOKIE_STORAGE};exports.useStorage=function(e,n){var o=t.useContext(c.StorageConfig),r=null!=n?n:o,s=i[r.storage||"localStorage"],u=r.initialValue,l=t.useRef(!0),g=function(){if("undefined"==typeof window)return console.warn("Tried setting ".concat(r.storage," key “").concat(e,"” even though environment is not a client")),u;var t,n=s.getItem(e);return null===n&&void 0!==u?(s.setItem(e,u),null===(t=window)||void 0===t||t.dispatchEvent(new Event("local-storage-".concat(e))),u):n},d=t.useState(g),f=a(d,2),S=f[0],v=f[1];return t.useEffect((function(){return function(){l.current=!1}}),[]),t.useEffect((function(){var t,n=function(){return l.current&&v(g())};return null===(t=window)||void 0===t||t.addEventListener("local-storage-".concat(e),n),function(){return window.removeEventListener("local-storage-".concat(e),n)}}),[]),[S,function(t){"undefined"==typeof window&&console.warn("Tried setting ".concat(r.storage," key “").concat(e,"” even though environment is not a client"));try{var n=t instanceof Function?t(S):t;s.setItem(e,n),l.current&&v(n),window.dispatchEvent(new Event("local-storage-".concat(e)))}catch(t){console.warn("Error setting localStorage key “".concat(e,"”:"),t)}}]};
