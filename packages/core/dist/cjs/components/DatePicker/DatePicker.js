"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("@babel/runtime/helpers/objectWithoutProperties")),t=require("react/jsx-runtime"),a=require("react"),n=(e(a),e(require("@babel/runtime/helpers/slicedToArray"))),i=require("@medly-components/icons"),l=require("@medly-components/utils"),o=e(require("@babel/runtime/helpers/defineProperty")),u=require("date-fns"),c=require("../TextField/TextField.js"),s=require("../Calendar/Calendar.js"),d=require("./DatePicker.styled.js"),f=require("./datePickerPattern.js");function p(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?p(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var b=a.memo(a.forwardRef((function(e,o){var p,b=e.value,m=e.onChange,h=e.size,D=e.displayFormat,g=e.fullWidth,y=e.minWidth,P=e.required,j=e.disabled,C=e.showDecorators,O=e.errorText,x=e.className,w=e.validator,S=e.popoverPlacement,k=e.minSelectableDate,q=e.maxSelectableDate,I=e.showCalendarIcon,W=e.calendarIconPosition,F=e.defaultMonth,T=e.defaultYear,E=r(e,["value","onChange","size","displayFormat","fullWidth","minWidth","required","disabled","showDecorators","errorText","className","validator","popoverPlacement","minSelectableDate","maxSelectableDate","showCalendarIcon","calendarIconPosition","defaultMonth","defaultYear"]),M=e.id||(null===(p=e.label)||void 0===p?void 0:p.toLowerCase().replace(/\s/g,""))||"medly-datepicker",R=a.useMemo((function(){return b instanceof Date?b:"string"==typeof b?l.parseToDate(b,D):null}),[b,D]),z=a.useRef(null),B=l.useCombinedRefs(o,a.useRef(null)),N=a.useState(0),Y=n(N,2),A=Y[0],$=Y[1],_=a.useState(""),L=n(_,2),U=L[0],G=L[1],H=a.useState(""),J=n(H,2),K=J[0],Q=J[1],V=a.useState(!1),X=n(V,2),Z=X[0],ee=X[1],re=a.useState(!1),te=n(re,2),ae=te[0],ne=te[1],ie=a.useMemo((function(){return!!O||!!K}),[O,K]);a.useEffect((function(){R&&G(u.format(R,D).replace(new RegExp("\\/|\\-","g")," $& "))}),[R,D]);var le=a.useCallback((function(e){var r=e.target.value,t=l.parseToDate(r,D),a="Invalid Date"!==(null==t?void 0:t.toString());G(r),m("Invalid Date"!==t.toString()?t:null),a&&ue(e)}),[D,m]),oe=a.useCallback((function(e){var r;(e.stopPropagation(),j)||(ee((function(e){return!e})),ne(!0),null===(r=B.current)||void 0===r||r.focus())}),[j]),ue=a.useCallback((function(r,t){var a,n=null===(a=B.current)||void 0===a?void 0:a.value,i=n&&l.parseToDate(n,D),o="Invalid Date"!==(null==i?void 0:i.toString()),u=e.required&&!n&&"Please fill in this field",c=(i<k||i>q)&&"Please select date from allowed range",s=n&&!o&&"Please enter a valid date",d=w&&w(i||null,r);Q(d||u||c||s||""),t&&t(r)}),[e.required,D,w,k,q]),ce=a.useCallback((function(r){var t;return(null===(t=B.current)||void 0===t?void 0:t.value)&&ue(r,e.onBlur)}),[e.onBlur,D]),se=a.useCallback((function(r){return ue(r,e.onInvalid)}),[e.onInvalid,D]),de=a.useCallback((function(r){ne(!0),e.onFocus&&e.onFocus(r)}),[e.onFocus]),fe=a.useCallback((function(e,r){m(e),ee(!1),Q(""),ne(!1),Q(w&&w(e,r)||"")}),[m]),pe=a.useCallback((function(){return""}),[]);l.useOuterClickNotifier((function(r){ne(!1),ee(!1),ae&&(ue(r,e.onBlur),e.onBlur&&e.onBlur(r))}),z),a.useEffect((function(){R&&!Z&&$((function(e){return e+1}))}),[R,Z]);var ve=function(){return t.jsx(d.DateIconWrapper,Object.assign({variant:E.variant,isErrorPresent:ie,isActive:ae,disabled:j,size:h},{children:t.jsx(i.DateRangeIcon,{id:"".concat(M,"-calendar-icon"),title:"".concat(M,"-calendar-icon"),onClick:oe,size:h},void 0)}),void 0)};return t.jsxs(d.Wrapper,Object.assign({id:"".concat(M,"-datepicker-wrapper"),ref:z,fullWidth:g,minWidth:y,size:h,className:x,variant:E.variant,placement:S},{children:[t.jsx(c.TextField,Object.assign({errorText:O||K,id:M,ref:B,required:P},I&&("left"===W?{prefix:ve}:{suffix:ve}),{fullWidth:!0,mask:D.replace(new RegExp("\\/|\\-","g")," $& ").toUpperCase(),pattern:f[D],size:h,disabled:j,showDecorators:C,value:U,onChange:le,validator:pe},v(v({},E),{},{onBlur:ce,onFocus:de,minWidth:y,onInvalid:se})),A),Z&&t.jsx(s.Calendar,{id:"".concat(M,"-calendar"),date:R,isErrorPresent:ie,onChange:fe,defaultMonth:F,defaultYear:T,minSelectableDate:k,maxSelectableDate:q},void 0)]}),void 0)})));b.defaultProps={label:"",value:null,variant:"filled",displayFormat:"MM/dd/yyyy",disabled:!1,required:!1,fullWidth:!1,minWidth:"20rem",minSelectableDate:new Date(1901,0,1),maxSelectableDate:new Date(2100,11,1),popoverPlacement:"bottom-start",showCalendarIcon:!0,showDecorators:!0,calendarIconPosition:"right"},b.displayName="DatePicker";var m=Object.assign(b,{Style:d.Wrapper});exports.DatePicker=m;
