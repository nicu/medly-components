"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("@babel/runtime/helpers/objectWithoutProperties")),i=require("react/jsx-runtime"),a=require("react"),r=(e(a),e(require("@babel/runtime/helpers/slicedToArray"))),l=require("@medly-components/icons"),n=require("@medly-components/utils"),s=require("../TextField/TextField.js"),o=require("./FlatVariant/FlatVariant.js"),u=require("./helpers.js"),d=require("./Options/Options.js"),c=require("./SingleSelect.styled.js"),f=require("./useKeyboardNavigation.js"),p=a.memo(a.forwardRef((function(e,p){var b=e.id,v=e.value,h=e.onChange,O=e.options,m=e.variant,x=e.minWidth,g=e.maxWidth,C=e.includesNestedOptions,S=e.fullWidth,j=e.disabled,W=e.showDecorators,q=e.onFocus,k=e.onBlur,y=e.className,N=e.validator,F=e.isSearchable,T=e.suffix,w=t(e,["id","value","onChange","options","variant","minWidth","maxWidth","includesNestedOptions","fullWidth","disabled","showDecorators","onFocus","onBlur","className","validator","isSearchable","suffix"]),D=a.useMemo((function(){var e;return b||(null===(e=w.label)||void 0===e?void 0:e.toLocaleLowerCase())||"medly-singleSelect"}),[b,w.label]),P=u.getDefaultSelectedOption(O,v),R=a.useRef(null),U=a.useRef(null),V=n.useCombinedRefs(p,a.useRef(null)),z=a.useRef(!1),A=a.useState(!1),B=r(A,2),E=B[0],K=B[1],M=a.useState(P.label),I=r(M,2),L=I[0],_=I[1],G=a.useState(P),H=r(G,2),J=H[0],Q=H[1],X=a.useState(""),Y=r(X,2),Z=Y[0],$=Y[1],ee=a.useState(u.getUpdatedOptions(O,P)),te=r(ee,2),ie=te[0],ae=te[1],re=a.useCallback((function(){return ae(u.getUpdatedOptions(O,J))}),[O,J]),le=a.useCallback((function(){var e;return $(N&&N(null===(e=V.current)||void 0===e?void 0:e.value)||w.required&&!v&&"Please select one option."||"")}),[w.required,N,v]),ne=a.useCallback((function(){var e;K(!0),F&&_(""),null===(e=V.current)||void 0===e||e.focus()}),[F,L]),se=a.useCallback((function(){K(!1),V.current&&V.current.blur()}),[]),oe=a.useCallback((function(){return!j&&(E?se():ne())}),[j,E]),ue=a.useCallback((function(e){var t=e.target.value,i=u.filterOptions(u.getUpdatedOptions(O,J),t);_(t),i.length&&t?ae(i):re(),1===i.length&&i[0].label===t?!E&&h&&h(i[0].value):E||K(!0)}),[E,O,J,re]),de=a.useCallback((function(e){var t;e.disabled||Array.isArray(e.value)?null===(t=V.current)||void 0===t||t.focus():(Q(e),ae(u.getUpdatedOptions(ie,e)),_(e.label),se(),h&&h(e.value),$(""))}),[V.current,ie,h]),ce=a.useCallback((function(){E&&(se(),le(),re(),_(P.label))}),[E,J,re,le]),fe=a.useCallback((function(e){z.current=!0,q&&q(e)}),[q]),pe=a.useCallback((function(){return""}),[]),be=a.useCallback((function(e){return!F&&e.preventDefault()}),[F]);n.useUpdateEffect((function(){var e=u.getDefaultSelectedOption(O,v);_(e.label),Q(e),ae(u.getUpdatedOptions(O,e)),v&&v!==e.value&&h&&h(e.value)}),[O,v]),f.useKeyboardNavigation({isFocused:z,selectedOption:J,options:ie,areOptionsVisible:E,setOptions:ae,handleOptionClick:de,showOptions:ne,optionsRef:U,hideOptions:se}),n.useOuterClickNotifier((function(){ce()}),R);var ve={id:"".concat(D),ref:V,value:L,label:w.label,helperText:w.helperText,errorText:w.errorText||Z,onFocus:fe,onBlur:k,onKeyPress:be,disabled:j,showDecorators:W,areOptionsVisible:E,onInvalid:le,validator:pe};return i.jsxs(c.Wrapper,Object.assign({id:"".concat(D,"-wrapper")},{disabled:j,maxWidth:g,fullWidth:S},{minWidth:"flat"===m?"fit-content":x,variant:m,ref:R,className:y,isSearchable:F,isErrorPresent:!!e.errorText,onClick:oe,areOptionsVisible:E},{children:["flat"==m?i.jsx(o.FlatVariant,Object.assign({},ve),void 0):i.jsx(s.TextField,Object.assign({fullWidth:!0,variant:m,autoComplete:"off",onChange:ue,suffix:T||l.ChevronDownIcon},w,ve,{minWidth:x,maxWidth:g,readOnly:!w.required&&!F}),void 0),!j&&E&&i.jsx(d,{size:"flat"===m?"S":w.size,ref:U,variant:m,id:"".concat(D,"-options"),options:ie,hasError:!!e.errorText,onOptionClick:de,maxWidth:g,includesNestedOptions:C},void 0)]}),void 0)})));p.displayName="SingleSelect",p.defaultProps={value:"",size:"M",label:"",minWidth:"20rem",variant:"filled",fullWidth:!1,required:!1,isSearchable:!1,includesNestedOptions:!1,placeholder:"Please Select . . .",showDecorators:!0};var b=Object.assign(p,{Style:c.Wrapper});exports.SingleSelect=b;
