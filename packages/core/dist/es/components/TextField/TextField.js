import e from"@babel/runtime/helpers/objectWithoutProperties";import{jsxs as t,jsx as r}from"react/jsx-runtime";import{memo as i,forwardRef as n,useState as o,useRef as a,useMemo as l,useCallback as s,useEffect as d}from"react";import u from"@babel/runtime/helpers/slicedToArray";import{useCombinedRefs as c}from"@medly-components/utils";import p from"@babel/runtime/helpers/defineProperty";import{HelperAndErrorTextTooltip as m}from"../HelperAndErrorTextTooltip/HelperAndErrorTextTooltip.js";import{getMaskedValue as f}from"./getMaskedValue.js";import{CharacterCount as h}from"./Styled/CharacterCount.styled.js";import{HelperAndErrorTextTooltipWrapper as v}from"./Styled/HelperAndErrorTextTooltipWrapper.styled.js";import{HelperText as g}from"./Styled/HelperText.styled.js";import{Label as b}from"./Styled/Label.styled.js";import{Prefix as x}from"./Styled/Prefix.styled.js";import{Suffix as y}from"./Styled/Suffix.styled.js";import{InnerWrapper as j}from"./Styled/InnerWrapper/InnerWrapper.styled.js";import{InputWrapper as T}from"./Styled/InputWrapper.styled.js";import{MaskPlaceholder as O}from"./Styled/MaskPlaceholder.styled.js";import{OuterWrapper as P}from"./Styled/OuterWrapper.styled.js";import{Input as S}from"./Styled/TextField.styled.js";function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C=i(n((function(i,n){var p=o(""),w=u(p,2),C=w[0],z=w[1],E=c(n,a(null)),L=i.id,A=i.value,H=i.size,F=i.label,k=i.minWidth,D=i.maxWidth,I=i.fullWidth,V=i.errorText,q=i.helperText,M=i.prefix,N=i.suffix,R=i.required,B=i.disabled,G=i.showDecorators,J=i.mask,K=i.placeholder,Q=i.multiline,U=i.minRows,X=i.validator,Y=i.className,Z=i.withCharacterCount,$=e(i,["id","value","size","label","minWidth","maxWidth","fullWidth","errorText","helperText","prefix","suffix","required","disabled","showDecorators","mask","placeholder","multiline","minRows","validator","className","withCharacterCount"]),_=l((function(){return L||"medly-textField"}),[L]),ee=l((function(){return!!F}),[F]),te=l((function(){return!!M}),[M]),re=l((function(){return!!N}),[N]),ie=l((function(){return!!V||!!C}),[V,C]),ne=l((function(){return!!(Z&&G&&i.maxLength&&i.maxLength>=0)}),[Z,G,i.maxLength]),oe=o(!!A||!!$.defaultValue),ae=u(oe,2),le=ae[0],se=ae[1],de=o(J),ue=u(de,2),ce=ue[0],pe=ue[1],me=o(0),fe=u(me,2),he=fe[0],ve=fe[1],ge=o(A?A.toString().length:$.defaultValue?$.defaultValue.toString().length:0),be=u(ge,2),xe=be[0],ye=be[1],je=s((function(e,t){var r;e.preventDefault();var i=e.target,n=X&&X(i.value,e)||"",o=X?n:i.validationMessage;z(o),X&&(null===(r=E.current)||void 0===r||r.setCustomValidity(n)),t&&t(e)}),[X,C]),Te=s((function(e){return e.stopPropagation()}),[]),Oe=s((function(){var e;return!B&&(null===(e=E.current)||void 0===e?void 0:e.focus())}),[E,B]),Pe=s((function(e){return je(e,i.onBlur)}),[je,i.onBlur]),Se=s((function(e){return je(e,i.onInvalid)}),[je,i.onInvalid]),we=s((function(e){var t=e.target.value?e.target.value.toString():"";if(ye(t.length),J){var r=f(e,J);e.target.value=r,pe("".concat(r).concat(J.substr(r.length)))}i.onChange&&i.onChange(e)}),[J,i.onChange]);return d((function(){se(!!A)}),[A]),d((function(){J&&A&&A.toString().length===J.length&&pe(A.toString())}),[A,J]),d((function(){var e;(null===(e=E.current)||void 0===e?void 0:e.offsetWidth)&&ve(E.current.offsetWidth)}),[]),t(P,Object.assign({fullWidth:I,minWidth:k,maxWidth:D,className:Y,id:"".concat(_,"-input-wrapper")},{children:[t(j,Object.assign({size:H,onClick:Oe,variant:i.variant,disabled:B,isErrorPresent:ie,isLabelPresent:ee,isTextPresent:le,minRows:U,multiline:Q},{children:[!!M&&G&&r(x,Object.assign({size:H},{children:r(M,{size:H},void 0)}),void 0),t(T,Object.assign({multiline:Q,size:H,variant:i.variant},{children:[r(S,Object.assign({ref:E,value:A,id:"".concat(_,"-input"),"aria-describedby":"".concat(_,"-helper-text"),required:R,disabled:B,placeholder:J||K||" ",isPrefixPresent:te,isSuffixPresent:re,isLabelPresent:ee,errorText:V||C,inputSize:H,variant:i.variant,as:Q?"textarea":"input",multiline:Q},W(W({},$),{},{onBlur:Pe,onInvalid:Se,onChange:we})),void 0),ce&&r(O,Object.assign({size:H,isLabelPresent:ee,variant:i.variant},{children:ce}),void 0),r(b,Object.assign({inputWidth:he,htmlFor:"".concat(_,"-input"),size:H,required:!!R,variant:i.variant,multiline:Q},{children:F}),void 0),ne&&i.maxLength&&r(h,Object.assign({variant:i.variant,size:H,multiline:Q,characterCount:xe,maxLength:i.maxLength,showTooltipForHelperAndErrorText:!!i.showTooltipForHelperAndErrorText},{children:"".concat(xe,"/").concat(i.maxLength)}),void 0)]}),void 0),i.showTooltipForHelperAndErrorText&&r(v,Object.assign({size:H,displayCharacterCount:ne,isSuffixPresent:re},{children:r(m,{id:_,errorText:V||C,helperText:q},void 0)}),void 0),!!N&&G&&r(y,Object.assign({size:H},{children:r(N,{size:H},void 0)}),void 0)]}),void 0),(ie||q)&&!i.showTooltipForHelperAndErrorText&&r(g,Object.assign({id:"".concat(_,"-helper-text"),onClick:Te,size:H,variant:i.variant},{children:(V||C||q||"").trim()}),void 0)]}),void 0)})));C.displayName="TextField",C.defaultProps={size:"M",type:"text",variant:"filled",minWidth:"20rem",fullWidth:!1,disabled:!1,required:!1,label:"",helperText:"",errorText:"",minRows:1,withCharacterCount:!1,showDecorators:!0,showTooltipForHelperAndErrorText:!1};var z=Object.assign(C,{Style:P});export{z as TextField};
