import e from"@babel/runtime/helpers/objectWithoutProperties";import{jsxs as t,jsx as a}from"react/jsx-runtime";import{memo as o,useRef as r,useState as n,useCallback as l,useMemo as i,useEffect as s}from"react";import d from"@babel/runtime/helpers/slicedToArray";import{useKeyPress as c,useOuterClickNotifier as m,useUpdateEffect as p}from"@medly-components/utils";import{OuterWrapper as u}from"../TextField/Styled/OuterWrapper.styled.js";import{CustomDateRangeOptions as D}from"./CustomDateRangeOptions/CustomDateRangeOptions.styled.js";import{DateRangeCalendar as T}from"./DateRangeCalendar/DateRangeCalendar.js";import{PopoverTypes as h,DateRangeSelectionEnum as f}from"./types.js";import{dateRangeHelpers as v}from"./helpers/dateRangeHelpers.js";import{DateRangeTextFields as b}from"./DateRangeTextFields/DateRangeTextFields.js";var g=o((function(o){var g=o.id,R=o.value,A=o.minWidth,C=o.fullWidth,S=o.displayFormat,E=o.startDateLabel,x=o.endDateLabel,y=o.errorText,w=o.helperText,O=o.variant,F=o.disabled,L=o.showDecorators,P=o.size,M=o.onBlur,N=o.minSelectableDate,j=o.maxSelectableDate,_=o.popoverPlacement,W=o.onChange,k=o.required,z=o.validator,H=o.withSingleMonth,I=o.showTooltipForHelperAndErrorText,q=o.customDateRangeOptions,B=o.onPopupClose,U=e(o,["id","value","minWidth","fullWidth","displayFormat","startDateLabel","endDateLabel","errorText","helperText","variant","disabled","showDecorators","size","onBlur","minSelectableDate","maxSelectableDate","popoverPlacement","onChange","required","validator","withSingleMonth","showTooltipForHelperAndErrorText","customDateRangeOptions","onPopupClose"]),G=r(null),V=r(null),J=r(null),K=r(null),Q=n(!1),X=d(Q,2),Y=X[0],Z=X[1],$=n(h.CALENDAR),ee=d($,2),te=ee[0],ae=ee[1],oe=n("START_DATE"),re=d(oe,2),ne=re[0],le=re[1],ie=l((function(e){var t;return null===(t=("START_DATE"===e?G:V).current)||void 0===t?void 0:t.focus()}),[]),se=c("Tab",!0,J),de=i((function(){return null!=A?A:(null==q?void 0:q.length)?"37.2rem":"33.8rem"}),[q,A]),ce=l((function(){F||(te===h.CUSTOM_RANGE_OPTIONS?Z((function(e){return!e})):(ae(h.CUSTOM_RANGE_OPTIONS),Z(!0)))}),[F,te]),me=l((function(e){ae(h.CALENDAR),Z(e)}),[]),pe=l((function(e){if(e.value===f.CUSTOM)ie("START_DATE"),ae(h.CALENDAR),Z(!0);else{var t=v[e.value]();N&&t.startDate&&t.startDate<N&&(t.startDate=N),j&&t.endDate&&t.endDate>j&&(t.endDate=j),W&&W(t),Z(!1)}}),[W,ie]);return m((function(e){Z(!1),Y&&B&&B(),Y&&K.current&&K.current(e)}),J),p((function(){return ie(ne)}),[ne]),s((function(){var e=document.activeElement;se&&"START_DATE"!==e.name&&"END_DATE"!==e.name&&Z(!1)}),[se]),t(u,Object.assign({id:"".concat(g,"-wrapper"),ref:J,fullWidth:C,minWidth:de},U,{onBlur:M},{children:[a(b,{id:g,size:P,required:k,variant:O,errorText:y,helperText:w,disabled:F,showDecorators:L,isActive:Y,activePopover:te,validator:z,startDateLabel:E,endDateLabel:x,selectedDates:R,onDateChange:W,displayFormat:S,onCalendarIconClick:me,setFocusedElement:le,startDateRef:G,endDateRef:V,showTooltipForHelperAndErrorText:I,onCustomRangeIconClick:ce,showChevronIcon:q.length>0,outerClickValidator:K},void 0),Y&&(te===h.CALENDAR?a(T,{id:"".concat(g,"-calendar"),size:P,placement:_,selectedDates:R,setActive:me,withSingleMonth:H,focusElement:ie,onDateSelection:W,focusedElement:ne,setFocusedElement:le,minSelectableDate:N,maxSelectableDate:j},void 0):a(D,{id:"".concat(g,"-custom-date-range-options"),size:P,variant:O,onOptionClick:pe,options:q,placement:_},void 0))]}),void 0)}));g.displayName="DateRangePicker",g.defaultProps={id:"medly-date-range-picker",size:"M",variant:"filled",startDateLabel:"From",endDateLabel:"To",displayFormat:"MM-dd-yyyy",popoverPlacement:"bottom-start",withSingleMonth:!1,minSelectableDate:new Date(1901,0,1),maxSelectableDate:new Date(2100,11,1),showDecorators:!0,customDateRangeOptions:[]};export{g as DateRangePicker};
