import{jsxs as e,jsx as t}from"react/jsx-runtime";import{memo as n,useState as a,useMemo as o,useCallback as r,useEffect as i}from"react";import c from"@babel/runtime/helpers/slicedToArray";import{KeyboardArrowLeftIcon as l,KeyboardArrowRightIcon as s}from"@medly-components/icons";import d from"@babel/runtime/helpers/defineProperty";import{MonthNavigation as m}from"../../Calendar/Calendar.styled.js";import{getMonthAndYearFromDate as D,getNextMonthAndYear as h,getPreviousMonthAndYear as f}from"../../Calendar/helper.js";import{MonthAndYearSelection as u}from"../../Calendar/MonthAndYearSelection/MonthAndYearSelection.js";import{DateRangeCalendar as p,Header as g,MonthsWrapper as b}from"./DateRangeCalendar.styled.js";import{Month as v}from"./Month/Month.js";function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=n((function(n){var d=n.id,y=n.size,O=n.setActive,S=n.placement,w=n.selectedDates,M=n.focusedElement,C=n.focusElement,A=n.setFocusedElement,E=n.onDateSelection,P=n.minSelectableDate,T=n.maxSelectableDate,k=n.withSingleMonth,x=w.startDate,R=w.endDate,Y=a(null),_=c(Y,2),z=_[0],F=_[1],N=a("move-in-left"),H=c(N,2),q=H[0],B=H[1],G=a(D(x||new Date)),I=c(G,2),J=I[0],K=J.month,L=J.year,Q=I[1],U=o((function(){return h(K,L)}),[K,L]),V=U.month,W=U.year,X=r((function(){return B("move-out-left")}),[]),Z=r((function(){return B("move-out-right")}),[]),$=r((function(e){"START_DATE"===M?(w.endDate&&e>=w.endDate?E({startDate:w.endDate,endDate:e}):E(j(j({},w),{},{startDate:e})),A("END_DATE")):(w.startDate&&e<=w.startDate?E({startDate:e,endDate:w.startDate}):E(j(j({},w),{},{endDate:e})),A("START_DATE"))}),[w,M]),ee=r((function(){C(M),O(!0)}),[M]),te=r((function(e){ee(),Q(e)}),[M]),ne=r((function(){"move-out-left"!==q&&"move-out-right"!==q||("move-out-left"===q?(Q((function(e){return h(e.month,e.year)})),B("move-in-left")):(Q((function(e){return f(e.month,e.year)})),B("move-in-right")))}),[q]),ae={startDate:x,endDate:R,minSelectableDate:P,maxSelectableDate:T,hoveredDate:z,setHoveredDate:F,onChange:$};return i((function(){w.startDate&&!w.endDate&&w.startDate.getMonth()!==K&&w.startDate.getMonth()!==V&&x&&Q(D(x)),w.endDate&&!w.startDate&&w.endDate.getMonth()!==K&&w.endDate.getMonth()!==V&&R&&Q(f(R.getMonth(),R.getFullYear()))}),[w.startDate,w.endDate]),e(p,Object.assign({id:d,size:y,placement:S,onClick:ee,withSingleMonth:k},{children:[e(g,{children:[k&&t(u,{id:d,month:K,year:L,onChange:te,minSelectableDate:P,maxSelectableDate:T},void 0),t(m,Object.assign({id:"".concat(d,"-navigation-backward"),onClick:Z},{children:t(l,{title:"".concat(d,"-navigation-backward-icon")},void 0)}),void 0),t(m,Object.assign({id:"".concat(d,"-navigation-forward"),onClick:X},{children:t(s,{title:"".concat(d,"-navigation-forward-icon")},void 0)}),void 0)]},void 0),e(b,Object.assign({id:"".concat(d,"-months-wrapper"),slideDirection:q,onAnimationEnd:ne},{children:[t(v,Object.assign({id:"".concat(d,"-").concat(K,"-month"),month:K,year:L},ae,{hideMonthText:k}),void 0),!k&&t(v,Object.assign({id:"".concat(d,"-").concat(V,"-month"),month:V,year:W},ae),void 0)]}),K)]}),void 0)}));O.displayName="DateRangeCalendar";var S=Object.assign(O,{Style:p});export{S as DateRangeCalendar};
