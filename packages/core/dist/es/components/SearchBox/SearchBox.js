import e from"@babel/runtime/helpers/objectWithoutProperties";import{jsxs as i,jsx as t}from"react/jsx-runtime";import{memo as n,forwardRef as o,useRef as r,useState as l,useEffect as s,useCallback as c}from"react";import a from"@babel/runtime/helpers/slicedToArray";import{CloseIcon as u,ExpandIcon as d,SearchIcon as h}from"@medly-components/icons";import{useCombinedRefs as m,useKeyPress as p,useOuterClickNotifier as f}from"@medly-components/utils";import v from"../SingleSelect/Options/Options.js";import{useKeyboardNavigation as g}from"../SingleSelect/useKeyboardNavigation.js";import{CloseIconWrapper as b,ExpandIconWrapper as S,SearchIconWrapper as O}from"./styles/icons.js";import{SearchBoxWrapper as j}from"./SearchBox.styled.js";import{CustomSearchFilterWrapper as C}from"./styles/customSearch.js";import{SearchInput as W}from"./styles/input.js";var y=n(o((function(n,o){var y=n.options,z=n.size,x=n.placeholder,F=n.onInputChange,N=n.onOptionSelected,k=n.onClear,B=n.onSearch,I=n.className,V=n.customSearchFilter,w=n.fullWidth,A=n.minWidth,K=n.maxWidth,P=e(n,["options","size","placeholder","onInputChange","onOptionSelected","onClear","onSearch","className","customSearchFilter","fullWidth","minWidth","maxWidth"]),T=r(null),E=m(o,r(null)),R=r(!1),q=r(null),D=l(!1),G=a(D,2),H=G[0],J=G[1],L=l(!1),M=a(L,2),Q=M[0],U=M[1],X=l(y||[]),Y=a(X,2),Z=Y[0],$=Y[1],_=l(!1),ee=a(_,2),ie=ee[0],te=ee[1],ne=l(!1),oe=a(ne,2),re=oe[0],le=oe[1],se=p("Enter",!0,q);s((function(){n.options&&($(n.options),U(H&&n.options.length>0))}),[n.options,H]);var ce=c((function(){var e;U(!0),null===(e=E.current)||void 0===e||e.focus()}),[]),ae=c((function(){var e;U(!1),null===(e=E.current)||void 0===e||e.blur(),J(!1)}),[]),ue=c((function(){return te(!0)}),[]),de=c((function(){return te(!1)}),[]),he=c((function(){E.current&&(E.current.value="",E.current.focus()),U(!1),le(!1),J(!1),k&&k()}),[]),me=c((function(e){var i=e.target.value;J(0!==i.length),le(0!==i.length),F&&F(i)}),[]),pe=c((function(e){E.current&&(E.current.value=e.label,E.current.focus()),U(!1),N&&N(e)}),[N]),fe=c((function(e){J(e.target.value.length>0),R.current=!0,Z.length>0&&U(!0)}),[Z]),ve=c((function(){R.current=!1}),[]),ge=c((function(){var e;return B&&B((null===(e=E.current)||void 0===e?void 0:e.value)||"")}),[B]);g({isFocused:R,options:Z,areOptionsVisible:Q,setOptions:$,handleOptionClick:pe,showOptions:ce,optionsRef:q}),f((function(){ae()}),T),s((function(){if(se&&R.current){var e,i,t=Z.find((function(e){return!0===e.hovered}));E.current&&t&&(E.current.value=t.label,N&&N(t),E.current.blur()),B&&B((null===(e=E.current)||void 0===e?void 0:e.value)||""),U(!1),le(0!==(null===(i=E.current)||void 0===i?void 0:i.value.length)),J(!1)}}),[se]);var be=!!V;return i(j,Object.assign({ref:T,areOptionsVisible:Q,size:z,className:I,hasCustomSearchFilter:be,minWidth:A,fullWidth:w,maxWidth:K},{children:[t(W,Object.assign({placeholder:x,onChange:me,ref:E,onFocus:fe,onBlur:ve},P),void 0),re&&t(b,Object.assign({showCloseIcon:re,size:z,hasCustomSearchFilter:be},{children:t(u,{title:"close icon",onClick:he,size:z},void 0)}),void 0),be&&t(S,Object.assign({size:z,isCustomSearchActive:ie},{children:t(d,{title:"expand icon",size:z,onClick:ie?de:ue},void 0)}),void 0),t(O,Object.assign({areOptionsVisible:Q,isTyping:H,size:z},{children:t(h,{title:"search icon",size:z,onClick:ge},void 0)}),void 0),Q&&Z&&t(v,{size:z,ref:q,options:Z,variant:"filled",onOptionClick:pe,maxWidth:K},void 0),ie&&t(C,Object.assign({size:z},{children:V}),void 0)]}),void 0)})));y.displayName="SearchBox",y.defaultProps={options:[],placeholder:"Search",size:"S",minWidth:"25.6rem",maxWidth:"100%",fullWidth:!1};var z=Object.assign(y,{Style:j});export{z as SearchBox};
